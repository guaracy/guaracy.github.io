<!DOCTYPE html>
<html lang="en"> 
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>100 doors</title>
<link rel="shortcut icon" href="favicon.ico" />
<style>
/*  this disables the annoying double click highlighting of DIV blocks  */
div { outline-style:none;}
</style>
</head>
<body style="margin:0; padding:0;">
<script type="module">
import * as std from '../../runtime/beads_std.js';
import { U, Y, N, POP, VAL, VNP, setv, gets, getn, addr } from '../../runtime/beads_std.js';
import * as str from '../../runtime/beads_str.js';
import * as k   from '../../runtime/beads_k.js';
export const CODE_HASH= 0x5e879700;
const _M = "100 doors";
std.rtl_init();
std.aaaa.main_init = main_init;
std.aaaa.main_module = "100 doors";
std.aaaa.main_drawer = new std.a_function("100 doors", "main_draw", main_draw, track_main_draw);
//------- enums
//[reflAAA]
std.merge_lit(_M,0,std.META,_M, std.F_mod_funcs, "main_draw", std.F_vv_funck, VAL, std.FK_DRAW, POP, "main_init", std.F_vv_funck, VAL, std.FK_CALC, POP, POP, std.F_mod_vars
, "color", std.F_vv_typek, VAL, std.TYPE_COLOR, POP, "doors", std.F_vv_typek, VAL, std.TYPE_ARRAY);
//[reflZZZ]
//-------  func const
const main_draw_F = new std.a_function("100 doors", "main_draw", main_draw, track_main_draw);
std.FUNCS[main_draw_F.hash]=main_draw_F;
//-------  top nodes
let doors = new std.a_tree("100 doors","doors", std.NF_TOPLEVEL|std.NF_STATEFUL|std.NF_LOGGED);
let color = U;

//====================
//   main_draw
//====================
export function main_draw(b) {
k.k_root2(b);
k.k_enter(b);
k.div_begin(b, new std.a_function(_M, "main_draw_cell", main_draw_cell, null), false, false, false);
  k.div_spa(b, 0, 2, std.al);
  var loop7 = new std.a_loop({ limit:10 });
  while (loop7.next()) {
    k.div_add(b, U, 0, 20, std.al, null, 0);
    k.div_spa(b, 0, 2, std.al);
  }
  k.div_spa(b, 1, 2, std.al);
  var loop8 = new std.a_loop({ limit:10 });
  while (loop8.next()) {
    k.div_add(b, U, 1, 20, std.al, null, 0);
    k.div_spa(b, 1, 2, std.al);
  }
  k.div_end(b);
  k.draw_grid(b);
k.k_leave(b);
}


//====================
//   main_draw_cell
//====================
function main_draw_cell(b) {
  k.k_enter(b);
  color = getn(doors, getn(b.extra, std.F_cell_seq)) === Y ? std.LIGHT_GREEN : std.LIGHT_CORAL;
  std.draw_rect(b, { fill:color, thick:std.pt_to_dots(b, 1) });
  std.draw_str(b, str.to_str(getn(b.extra, std.F_cell_seq), {}), { size:std.div(b.bounds.height, 2) });
  k.k_leave(b);
}

//====================
//   track_main_draw
//====================
export function track_main_draw(b, e) {
  //---------------
  //   on EV_TAP
  //---------------
  if (std.getn(e, std.F_evkind) == std.EV_TAP) {
    if (getn(doors, getn(b.extra, std.F_cell_seq)) === Y) {
      std.log("Aberta");
    } else {
      std.log("Fechada");
    }
  return Y;
  }
  return N;
}

//====================
//   main_init
//====================
export function main_init() {
  var loop9 = new std.a_loop({ from:1, to_:100 });
  while (loop9.next()) {
  var ix = loop9.index;
    std.path_setv(_M, 9, std.addr(doors, ix), N);
  }
  var loop10 = new std.a_loop({ from:1, to_:100 });
  while (loop10.next()) {
  var i = loop10.index;
    var loop11 = new std.a_loop({ from:i, to_:100, by:i });
    while (loop11.next()) {
    var ix = loop11.index;
      std.path_setv(_M, 12, std.addr(doors, ix), std.not4(getn(doors, ix)));
    }
  }
}

main_init();
k.rebuild_all();

</script>
</body>
</html>
